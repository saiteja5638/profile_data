sap.ui.define(["sap/ui/core/mvc/Controller"],function(e){"use strict";var t;return e.extend("orderdata.controller.View1",{onInit:function(){t=this;if(!t.create){t.create=sap.ui.xmlfragment("orderdata.view.create",t)}if(!t.downloadTem){t.downloadTem=sap.ui.xmlfragment("orderdata.view.downloadtem",t)}},onValueHelpRequest:function(e){if(!this.suggestDialog){this.suggestDialog=this.loadFragment({name:"orderdata.view.SelectProd"})}this.suggestDialog.then(e=>{e.open()}).then(()=>{var e=this.getOwnerComponent().getModel("oData");var o=new sap.ui.model.json.JSONModel;e.read("/Options",{success:async function(e){var n=e.results;const a=n.filter(e=>n.indexOf(e)>0);await o.setData({items:a});t.byId("_IDGe").setModel(o)},error:function(e){console.log(e)}})})},onValueHelpRequest1:function(){if(!t.suggestUniq){t.suggestUniq=t.loadFragment({name:"orderdata.view.SelectUniq"})}t.suggestUniq.then(e=>{e.open()}).then(()=>{if(t.create.isOpen()){var e=new sap.ui.model.json.JSONModel;var o=t.getOwnerComponent().getModel("oData");var n=sap.ui.getCore().byId("Configurable_Product_1").getValue();o.read("/ORDERS",{success:function(o){var a=[];o.results.forEach(e=>{if(e.PRODUCT===n){a.push(e)}});e.setData({items:a});t.byId("_IDGe25bfvbfb").setModel(e)},error:function(e){console.log(e)}})}else{var a=new sap.ui.model.json.JSONModel;var o=t.getOwnerComponent().getModel("oData");var r=this.byId("_IDGenInput2").mProperties.value;o.read("/ORDERS",{success:function(e){var o=[];e.results.forEach(e=>{if(e.PRODUCT===r){o.push(e)}});a.setData({items:o});t.byId("_IDGe25bfvbfb").setModel(a)},error:function(e){console.log(e)}})}})},onValueHelpDialogClose:function(e){var o=e.getParameter("selectedItem");if(!o){return}const n=o.getTitle();if(t.create.isOpen()){sap.ui.getCore().byId("Configurable_Product_1").setValue(n)}else{t.byId("_IDGenInput2").setValue(n)}},onValueHelpDialogClose1:function(e){var o=e.getParameter("selectedItem");if(!o){return}const n=o.getTitle();if(t.create.isOpen()){sap.ui.getCore().byId("UniqueType_1").setValue(n)}else{t.byId("_IDGenInput3").setValue(n)}},Go:function(){var e=t.getOwnerComponent().getModel("oData");var o=this.byId("_IDGenInput2").mProperties.value;if(!o){alert("Please select the Product !")}let n=t.byId("_IDGenInput3").getValue();let a=t.byId("dateRangeSelection");var r=new sap.ui.model.json.JSONModel;e.read("/ORDERS",{success:function(e){var s=e.results.filter(e=>e.PRODUCT==o);if(n){s=s.filter(e=>e.UNIQUEID==n)}if(a.getFrom()&&a.getTo()){s=s.filter(e=>new Date(e.CREADTEDDATE)>=new Date(a.getFrom())&&new Date(e.CREADTEDDATE)<=new Date(a.getTo()))}r.setData({items:s});t.byId("table").setModel(r)},error:function(e){console.log(e)}})},onCreate:function(){t.create.open();sap.ui.getCore().byId("Configurable_Product_1").setValue("");sap.ui.getCore().byId("UniqueType_1").setValue("");sap.ui.getCore().byId("Order_quantity").setValue("");sap.ui.getCore().byId("Date_range_125").setValue("")},onCloseorder:function(){t.create.close()},onOrderSubmit:function(){var e=t.getOwnerComponent().getModel("oData");let o=sap.ui.getCore().byId("Date_range_125");var n=new Date;var a=sap.ui.core.format.DateFormat.getDateInstance({pattern:"dd/MM/yyyy"});var r=a.format(n);e.read("/ORDERS",{success:function(t){const n=t.results;const a={SEEDORDER:"SE0000"+(n.length+1),PRODUCT:sap.ui.getCore().byId("Configurable_Product_1").getValue(),UNIQUEID:sap.ui.getCore().byId("UniqueType_1").getValue(),ORDERQUANTITY:sap.ui.getCore().byId("Order_quantity").getValue(),MATERIALAVAILDATE:o.getValue(),CREADTEDDATE:r};var s=[];s.push(a);e.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"O",Data:JSON.stringify(s)},success:function(){console.log("successfully created")},error:function(){console.log(error)}})}});t.create.close()},seed_search:function(){const e=t.byId("LiveSearch").getProperty("value");var o=[];o.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("SEEDORDER",sap.ui.model.FilterOperator.Contains,e),new sap.ui.model.Filter("SEEDORDER",sap.ui.model.FilterOperator.Contains,e)],and:false}));var n=t.byId("table");var a=n.getBinding("items");a.filter(o)},reset:function(){t.byId("dateRangeSelection").setValue("");t.byId("_IDGenInput3").setValue("");this.byId("_IDGenInput2").setValue("");t.byId("table").setModel(new sap.ui.model.json.JSONModel({}))},open_Download_tem:function(){t.downloadTem.open()},close_Download_tem:function(){t.downloadTem.close()},download_file:function(){const e=sap.ui.getCore().byId("_IDGenDateRangeSelection1");function t(e,t){const o=[];const n=new Date(e);const a=new Date(t);while(n<=a){if(n.getDay()===1){o.push(new Date(n))}n.setDate(n.getDate()+1)}return o}const o=e.getFrom();const n=e.getTo();const a=t(o,n);console.log(a);const r=[{Name:"John",Age:30,City:"New York"},{Name:"Jane",Age:25,City:"London"}];var s=XLSX.utils.book_new();var i=XLSX.utils.json_to_sheet(r);XLSX.utils.book_append_sheet(s,i,"Sheet1");XLSX.writeFile(s,"data.xlsx")}})});