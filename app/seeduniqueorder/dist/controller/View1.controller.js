sap.ui.define(["sap/ui/core/mvc/Controller","sap/f/library","sap/ui/core/Fragment","sap/m/MessageToast","sap/ui/model/Sorter"],function(e,t,o,n,s){"use strict";var a;return e.extend("seeduniqueorder.controller.View1",{onInit:function(){a=this;this.bus=this.getOwnerComponent().getEventBus();if(!a.Sample){a.Sample=sap.ui.xmlfragment("seeduniqueorder.view.characteroptions",a)}if(!a.create){a.create=new sap.ui.xmlfragment("seeduniqueorder.view.create",a)}if(!a.copy){a.copy=new sap.ui.xmlfragment("seeduniqueorder.view.copy",a)}if(!a.copy_options){a.copy_options=new sap.ui.xmlfragment("seeduniqueorder.view.characteristics_options",a)}var e=a.getOwnerComponent().getModel("oData")},handleListPress:function(){var e=this.oView.getParent().getParent();e.setLayout(t.LayoutType.TwoColumnsMidExpanded);var o=a.getView().byId("table");var n=this.byId("_IDGenInput1").mProperties.value;var s=this.byId("_IDGenComboBox1")._lastValue;var r=o.getSelectedItem().getBindingContext().getObject();var i=this.getOwnerComponent().getModel("oData");var l=[];var g=[];i.read("/Unique_ID_ITEM1",{success:function(e){for(var t=0;t<e.results.length;t++){if(r.UNIQUE_ID==e.results[t].UNIQUE_ID){l.push(e.results[t])}}i.read("/CHAR_NUMVAL1",{success:function(e){var t=e.results;for(var o=0;o<l.length;o++){for(var s=0;s<t.length;s++){if(!(l[o].NEW_VAL==null)){if(l[o].CHAR_NUM==t[s].CHAR_NUM&&l[o].CHAR_NUMVAL==t[s].CHAR_NUMVAL&&l[o].NEW_VAL==t[s].CHAR_NUMVALDESC){g.push(t[s])}}else{if(l[o].CHAR_NUM==t[s].CHAR_NUM&&l[o].CHAR_NUMVAL==t[s].CHAR_NUMVAL){g.push(t[s])}}}}var i=a.getOwnerComponent().getModel("oGmodel1");var u={prod:n,uid:r.UNIQUE_ID};const c=[];c.push(u);i.setData({items:c});var d=a.getOwnerComponent().getModel("oGmodel");d.setData({items2:g});var C=sap.ui.controller("seeduniqueorder.controller.Detail");C.getDetail()}})}})},go:function(){var e=new sap.ui.model.json.JSONModel;var t=this.getOwnerComponent().getModel("oData");t.read("/Options",{success:function(t){var o=t.results.shift();e.setData({items:o})},error:function(e){console.log(e)}});sap.ui.getCore().byId("_IDGenSelectDialog1").setModel(e)},Listclick:function(){var e=this.getOwnerComponent().getModel("oData");var t=a.getView().byId("table");var o=new sap.ui.model.json.JSONModel;var s=this.byId("_IDGenInput1").mProperties.value;var r=this.byId("_IDGenComboBox1")._lastValue;if(!s){n.show("Please select the Product_type")}else{e.read("/Unique_ID_Header1",{success:function(e){var n=[];for(var i=0;i<e.results.length;i++){if(r=="P"||r=="U"){if(e.results[i].PRODUCT_ID==s&&r){if(e.results[i].UID_TYPE==r){n.push(e.results[i])}}}else{if(e.results[i].PRODUCT_ID==s){n.push(e.results[i])}}}o.setData({items:n});t.getItems()[0].setSelected(true);a.handleListPress()}});this.getView().byId("table").setModel(o);a.Table_sort()}},Selectedrowitem:function(){var e=this.byId("table").getSelectedItem();var t=e.getBindingContext().getObject();var o=this.getOwnerComponent().getModel("oData");var n=[];var s=[];o.read("/Unique_ID_ITEM1",{success:function(e){for(var o=0;o<e.results.length;o++){if(t.UNIQUE_ID==e.results[o].UNIQUE_ID){n.push(e.results[o])}}}});o.read("/CHAR_NUMVAL1",{success:function(e){var t=e.results;for(var o=0;o<t.length;o++){if(n[0].CHAR_NUM==t[o].CHAR_NUM&&n[0].CHAR_NUMVAL==t[o].CHAR_NUMVAL){s.push(t[o])}}}});var a=this.getOwnerComponent().getModel("oGmodel");a.setData({items:s})},onValueHelpRequest:function(){if(!this.suggestDialog){this.suggestDialog=this.loadFragment({name:"seeduniqueorder.view.selection"})}this.suggestDialog.then(e=>{e.open()}).then(()=>{var e=this.getOwnerComponent().getModel("oData");var t=new sap.ui.model.json.JSONModel;e.read("/Options",{success:async function(e){var o=e.results;const n=o.filter(e=>o.indexOf(e)>0);await t.setData({items:n});a.byId("_IDGe").setModel(t)},error:function(e){console.log(e)}})})},onValueHelpDialogClose:function(e){var t=e.getParameter("selectedItem");if(!t){return}const o=t.getTitle();a.byId("_IDGenInput1").setValue(o)},Create_unique_Character:function(){var e=this.byId("table");var t=this.byId("_IDGenInput1").mProperties.value;var o=this.byId("_IDGenComboBox1")._lastValue;if(!(e.getSelectedItem()&&t&&o)){alert("Please select the Product_type")}else{var n=e.getSelectedItem().getBindingContext().getObject();sap.ui.getCore().byId("Configurable_Product").setValue(t);sap.ui.getCore().byId("UniqueType").setSelectedKey(n.UID_TYPE);sap.ui.getCore().byId("ActiveStatus").setValue(n.ACTIVE);a.create.open()}},onOptions_selectDialog:function(){a.Sample.open();var e=this.getOwnerComponent().getModel("oData");var t=new sap.ui.model.json.JSONModel;e.read("/CHAR_NUMVAL1",{success:function(e){var e=e.results;const t=[];const o=new Set;for(const n of e){const e=n.CHARVAL_NUM;if(!o.has(e)){t.push(n);o.add(e)}}var n=[];for(var s=0;s<t.length;s++){var a={CHARVAL_NUM:t[s].CHARVAL_NUM};var r=0;for(var i=0;i<e.length;i++){if(t[s].CHARVAL_NUM==e[i].CHARVAL_NUM){a["name"+r++]=e[i].CHAR_NUMVALDESC}}n.push(a)}var l=new sap.ui.model.json.JSONModel;l.setData({items4:n});sap.ui.getCore().byId("idList1").setModel(l)},error:function(e){console.log(e)}});var o=sap.ui.getCore().byId("idList1").getItems();if(sap.ui.getCore().byId("table3").getItems().length>0){sap.ui.getCore().byId("table3").getItems().forEach(e=>{o.forEach(t=>{if(t.getContent()[0].getHeaderText()==e.getBindingContext().getObject().CHARVAL_NUM){t.getContent()[0].getContent()[0].getButtons().forEach(t=>{if(t.getText()==e.getBindingContext().getObject().CHAR_NUMVALDESC){t.setSelected(true);t.getParent().getParent().setExpanded(true)}})}})})}},onOptions_select_close:function(){a.Sample.close();var e=sap.ui.getCore().byId("idList1").getItems();e.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})},onClose_create:function(){sap.ui.getCore().byId("table3").setModel(new sap.ui.model.json.JSONModel({}));a.create.close();sap.ui.getCore().byId("UniqueDescription").setValue("");var e=sap.ui.getCore().byId("idList1").getItems();e.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})},create_char_search:function(e){var t=e.getParameters().newValue;var o=sap.ui.getCore().byId("idList1");var n=o.getBinding("items");var s=[];if(t&&t.length>0){s.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("CHARVAL_NUM",sap.ui.model.FilterOperator.Contains,t)],and:false}));o.getItems().forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})}n.filter(s);if(t.length<1){var a=sap.ui.getCore().byId("idList1").getItems();if(sap.ui.getCore().byId("table3").getItems().length>0){sap.ui.getCore().byId("table3").getItems().forEach(e=>{a.forEach(t=>{if(t.getContent()[0].getHeaderText()==e.getBindingContext().getObject().CHARVAL_NUM){t.getContent()[0].getContent()[0].getButtons().forEach(t=>{if(t.getText()==e.getBindingContext().getObject().CHAR_NUMVALDESC){t.setSelected(true);t.getParent().getParent().setExpanded(true)}})}})})}}},chars_values_add:function(e){let t=[];sap.ui.getCore().byId("table3").getItems().forEach(e=>{t.push(e.getBindingContext().getObject())});console.log(t);var o=a.getOwnerComponent().getModel("oModel2");var n=[];e.getSource().getButtons().forEach(e=>{if(e.getSelected()){var t={CHAR_NUMVALDESC:e.getText(),CHARVAL_NUM:e.getParent().getParent().getHeaderText()};n.push(t)}});let s=t.concat(n);o.setData({items5:s});sap.ui.getCore().byId("table3").setModel(o)},delete_row:function(e){var t=sap.ui.getCore().byId("table3").getModel().getData().items5;let o=parseInt(e.getSource().getBindingContext().getPath().split("/")[2]);const n=t.filter(e=>t.indexOf(e)!==o);const s=new sap.ui.model.json.JSONModel;s.setData({items5:n});sap.ui.getCore().byId("table3").setModel(s)},Unique_desc_search:function(e){var t=e.getParameters().newValue;var o=[];if(t&&t.length>0){o.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("UNIQUE_ID",sap.ui.model.FilterOperator.EQ,t),new sap.ui.model.Filter("UNIQUE_DESC",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("UID_TYPE",sap.ui.model.FilterOperator.Contains,t)],and:false}))}var s=this.getView().byId("table");var a=s.getBinding("items");if(a){a.filter(o)}else{n.show("No Data in Table")}},Characteristic_value_search:function(e){var t=e.getParameters().newValue;var o=this.getView().byId("table4");var n=o.getBinding("items");var s=[];if(t&&t.length>0){s.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("CHARVAL_NUM",sap.ui.model.FilterOperator.Contains,t),new sap.ui.model.Filter("CHAR_NUMVALDESC",sap.ui.model.FilterOperator.Contains,t)],and:false}))}if(t.length<1){}n.filter(s)},OnCreate_submit:function(){a.create.close();var e=sap.ui.getCore().byId("idList1").getItems();e.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})});var t=this.getOwnerComponent().getModel("oData");var o=this.byId("table");var s=sap.ui.getCore().byId("table3").getItems();var r=this.getOwnerComponent().getModel("oGmodel");var i=[];var l=[];t.read("/Unique_ID_Header1",{success:function(e){var r=e.results;var g={UNIQUE_ID:r.length+1,PRODUCT_ID:sap.ui.getCore().byId("Configurable_Product").getValue(),UID_TYPE:sap.ui.getCore().byId("UniqueType").getSelectedKey(),ACTIVE:o.getSelectedItem().getBindingContext().getObject().ACTIVE,UNIQUE_DESC:sap.ui.getCore().byId("UniqueDescription").getValue()};i.push(g);t.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"V1",Data:null},success:function(e){var o=JSON.parse(e.seed_order);for(var n=0;n<s.length;n++){for(var r=0;r<o.length;r++){if(s[n].getBindingContext().getObject().CHARVAL_NUM==o[r].CHARVAL_NUM&&s[n].getBindingContext().getObject().CHAR_NUMVALDESC==o[r].CHAR_NUMVALDESC){let e={UNIQUE_ID:i[0].UNIQUE_ID,PRODUCT_ID:i[0].PRODUCT_ID,CHAR_NUM:parseInt(o[r].CHAR_NUM),CHAR_NUMVAL:o[r].CHAR_NUMVAL,NEW_VAL:s[n].getBindingContext().getObject().CHAR_NUMVALDESC};l.push(e)}}}console.log(l);t.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"C",Data:JSON.stringify(i)},success:function(){console.log("Successfully created ")},error:function(e){console.log(e)}});t.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"C1",Data:JSON.stringify(l)},success:function(){console.log("successfully created")},error:function(e){console.log(e)}});a.Listclick()},err:function(e){console.log(e)}});n.show("Sucessfully created")}})},Switch_case_change:function(e){var t=this.getOwnerComponent().getModel("oData");var o=e.getSource().getState();var n=[];var s={UNIQUE_ID:e.getSource().getBindingContext().getObject().UNIQUE_ID,ACTIVE:o};n.push(s);t.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"U",Data:JSON.stringify(n)},success:function(e){console.log("successfully created")},error:function(e){console.log(e)}})},Copy_fragment_open:function(){var e=this.byId("table");var t=this.byId("_IDGenInput1").mProperties.value;var o=this.byId("_IDGenComboBox1")._lastValue;if(!(e.getSelectedItem()&&t&&o)){alert("Please select the options")}else{var n=e.getSelectedItem().getBindingContext().getObject();sap.ui.getCore().byId("Configurable_Product1").setValue(t);sap.ui.getCore().byId("UniqueType1").setSelectedKey(n.UID_TYPE);sap.ui.getCore().byId("ActiveStatus1").setValue(n.ACTIVE);sap.ui.getCore().byId("UniqueDescription1").setValue(n.UNIQUE_DESC);var s=a.getOwnerComponent().getModel("oGmodel");sap.ui.getCore().byId("table6").setModel(s);a.copy.open()}},Copy_fragment_close:function(){sap.ui.getCore().byId("table6").setModel(new sap.ui.model.json.JSONModel({}));a.copy.close()},characetristicsclose:function(){a.copy_options.close();var e=sap.ui.getCore().byId("idList").getItems();e.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})},copy_characteristics_options:function(){var e=this.getOwnerComponent().getModel("oData");e.read("/CHAR_NUMVAL1",{success:function(e){var t=e.results;const o=[];const n=new Set;for(const e of t){const t=e.CHARVAL_NUM;if(!n.has(t)){o.push(e);n.add(t)}}var s=[];for(var r=0;r<o.length;r++){var i={CHARVAL_NUM:o[r].CHARVAL_NUM};var l=0;for(var g=0;g<t.length;g++){if(o[r].CHARVAL_NUM==t[g].CHARVAL_NUM){i["name"+l++]=t[g].CHAR_NUMVALDESC}}s.push(i)}var u=new sap.ui.model.json.JSONModel;u.setData({items4:s});sap.ui.getCore().byId("idList").setModel(u);var c=a.getOwnerComponent().getModel("oGmodel");var d=sap.ui.getCore().byId("idList");var C=sap.ui.getCore().byId("table6").getItems();C.forEach(e=>{d.getItems().forEach(t=>{if(t.getContent()[0].getHeaderText()===e.getBindingContext().getObject().CHARVAL_NUM){t.getContent()[0].getContent()[0].getButtons().forEach(t=>{if(t.getText()==e.getBindingContext().getObject().CHAR_NUMVALDESC){t.getParent().getParent().setExpanded(true);t.setSelected(true)}})}})})},err:function(e){console.log(e)}});a.copy_options.open()},on_characteristics_submit:function(){a.copy_options.close();var e=sap.ui.getCore().byId("idList");var t=[];sap.ui.getCore().byId("table6").getItems().forEach(e=>{t.push(e.getBindingContext().getObject())});var o=new sap.ui.model.json.JSONModel;var n=[];e.getItems().forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(t=>{if(t.getSelected()){var o={CHARVAL_NUM:e.getContent()[0].getHeaderText(),CHAR_NUMVALDESC:t.getText()};n.push(o)}})});let s=t.concat(n);s=s.map(e=>({CHARVAL_NUM:e.CHARVAL_NUM,CHAR_NUMVALDESC:e.CHAR_NUMVALDESC}));let r=s.filter((e,t)=>{const o=JSON.stringify(e);return t===s.findIndex(e=>JSON.stringify(e)===o)});o.setData({items2:r});sap.ui.getCore().byId("table6").setModel(new sap.ui.model.json.JSONModel({}));sap.ui.getCore().byId("table6").setModel(o);var i=sap.ui.getCore().byId("idList").getItems();i.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})},copy_charac_search:function(e){var t=e.getParameters().newValue;var o=sap.ui.getCore().byId("idList");var n=o.getBinding("items");var s=[];if(t&&t.length>0){s.push(new sap.ui.model.Filter({filters:[new sap.ui.model.Filter("CHARVAL_NUM",sap.ui.model.FilterOperator.Contains,t)],and:false}));var a=sap.ui.getCore().byId("idList").getItems();a.forEach(e=>{e.getContent()[0].getContent()[0].getButtons().forEach(e=>{e.setSelected(false)})})}if(t.length<1){var r=sap.ui.getCore().byId("idList");var i=sap.ui.getCore().byId("table6").getItems();i.forEach(e=>{r.getItems().forEach(t=>{if(t.getContent()[0].getHeaderText()===e.getBindingContext().getObject().CHARVAL_NUM){t.getContent()[0].getContent()[0].getButtons().forEach(t=>{if(t.getText()==e.getBindingContext().getObject().CHAR_NUMVALDESC){t.getParent().getParent().setExpanded(true);t.setSelected(true)}})}})})}var i=n.filter(s)},delete_row_6:function(e){var t=sap.ui.getCore().byId("table6").getModel().getData().items2;var o=parseInt(e.getSource().getBindingContext().getPath().split("/")[2]);let n=t.filter(e=>t.indexOf(e)!==o);var s=new sap.ui.model.json.JSONModel;s.setData({items2:n});sap.ui.getCore().byId("table6").setModel(s)},on_copy_data_submit:function(){var e=this.byId("table");var t=sap.ui.getCore().byId("table6").getItems();var o=this.getOwnerComponent().getModel("oData");var s=[];var r=[];o.read("/Unique_ID_Header1",{success:function(n){var i=n.results;var l={UNIQUE_ID:i.length+1,PRODUCT_ID:sap.ui.getCore().byId("Configurable_Product1").getValue(),UID_TYPE:sap.ui.getCore().byId("UniqueType1").getSelectedKey(),ACTIVE:e.getSelectedItem().getBindingContext().getObject().ACTIVE,UNIQUE_DESC:sap.ui.getCore().byId("UniqueDescription1").getValue()};s.push(l);o.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"V1",Data:null},success:function(e){var n=JSON.parse(e.seed_order);for(var i=0;i<t.length;i++){for(var l=0;l<n.length;l++){if(t[i].getBindingContext().getObject().CHARVAL_NUM==n[l].CHARVAL_NUM&&t[i].getBindingContext().getObject().CHAR_NUMVALDESC==n[l].CHAR_NUMVALDESC){var g={UNIQUE_ID:s[0].UNIQUE_ID,PRODUCT_ID:s[0].PRODUCT_ID,CHAR_NUM:parseInt(n[l].CHAR_NUM),CHAR_NUMVAL:n[l].CHAR_NUMVAL,NEW_VAL:t[i].getBindingContext().getObject().CHAR_NUMVALDESC};r.push(g)}}}o.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"C",Data:JSON.stringify(s)},success:function(){console.log("Successfully created ")},error:function(e){console.log(e)}});o.callFunction("/seed_order",{method:"GET",urlParameters:{FLAG:"C1",Data:JSON.stringify(r)},success:function(){console.log("successfully created")},error:function(e){console.log(e)}});a.Listclick()}})},err:function(e){console.log(e)}});n.show("Sucessfully created");a.copy.close()},Sample123:function(){console.log("what is that ")},Table_sort:function(){var e=a.byId("table");var t=e.getBinding("items");var o=new s("UNIQUE_ID",false);t.sort(o)}})});